---
layout: article
title: "[WriteUp]CodeGate2020"
key: 20200114
tags:
  - WriteUp
  - Reversing
  - CTF
toc: true
mathjax: true
mathjax_autoNumber: true
published : true
---

# [+] Enigma

<!--more-->

## [0x00] Analysis

```
DON'T LET YOUR RIGHT HAND KNOW WHAT YOUR LEFT HAND DID
5+,'( "2( )+-3 r-/:( :*,5 ',+1 1:*( )+3 "26( :*,5 5-d


ONCE A HACKER IS AN ETERNAL HACKER
+,92 * :*9'23 -4 *, 2(23,*" :*9'23


A HACKER WITHOUT PHILOSOPHY IS JUST AN EVIL COMPUTER GENIUS
* :*9'23 1-(:+-( @:-"+4+@:) -4 ;_4( *, 2?-" 9+.@_(23 /2,-_4

flag is :
9+52/*(22020{:*9'234 *32 ,+( !+3, +,") -( -4 .*52}
```

알파뱃과 문자들이 1:1로 매칭되어 있다. 예를 들어 `DON'T` 라는 문자열은 `5+,'(` 으로 되어있다. 아래 `flag is : ` 의 암호문을 위의 문자들과 매칭하여 해결할 수 있다.

## [0x01] Flag

```
CODEGATE2020{HACKERS ARE NOT BORN IT IS MADE}
```



# [+] LoL

## [0x00] Analysis

`League Of Legend` 라는 게임의 징크스 캐릭터 이미지가 문제이다. 확장자는 `gif`로 되어있으나 실제 바이너리를 확인하면 `JPEG` 파일임을 알 수 있다.

`JPEG` 의 헤더와 이미지의 끝을 알리는 시그니처 값이 존재한다. 시작은 `FF D8` 이며 끝은 `FF D9` 이다. 
`HxD` 를 이용하여 확인하면 여러 개의 파일이 존재하는 것을 의심할 수 있다. 

`binwalk` 를 이용하여 확인하면 파일 내부에 다른 그림 파일들이 존재하므로 추출하여 그림을 확인한다.

```
root@VM-Shh0ya:/home/shh0ya/01_CTF/a25d7f636b538ec7d456bda96828164f# binwalk --dd=jpeg Legend.gif 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard 1.01
382           0x17E           Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
91345         0x164D1         JPEG image data, JFIF standard 1.01
91727         0x1664F         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
183730        0x2CDB2         JPEG image data, JFIF standard 1.01
184112        0x2CF30         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
293597        0x47ADD         JPEG image data, JFIF standard 1.01
293979        0x47C5B         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
404067        0x62A63         JPEG image data, JFIF standard 1.01
404449        0x62BE1         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
508909        0x7C3ED         JPEG image data, JFIF standard 1.01
509291        0x7C56B         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
605001        0x93B49         JPEG image data, JFIF standard 1.01
605383        0x93CC7         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
688620        0xA81EC         JPEG image data, JFIF standard 1.01
772953        0xBCB59         JPEG image data, JFIF standard 1.01
773335        0xBCCD7         Copyright string: "Copyright (c) 1998 Hewlett-Packard Company"
```

추출 된 그림들에서 `A81EC` 라는 그림에 플래그가 존재한다.

 ## [0x01] Flag

이미지



# [+] SimpleMachine

## [0x00] Analysis

SimpleMachine 이라는 이름에서 알 수 있듯이 코드 가상화와 관련된 문제라 예상할 수 있다. `Target` 파일은 난독화 된 Opcode로 이루어져있으며 SimpleMachine은 이를 해석하여 동작하게 해주는 것이라 예상할 수 있다.

실제 실행하면 Target 파일은 단순히 어떠한 입력 값을 받는 프로그램인 것을 알 수 있다. IDA Remote Debugger를 이용하여 문제에 접근해본다.

 최초 `simplemachine`을 실행 시, 아래와 같이 실행하게 되어있으며 입력 값을 받는 것을 확인할 수 있다.

```
shh0ya@VM-Shh0ya:~/01_CTF/116ea16dbeabe08d1fe8891a27d0f16b$ ./simple_machine target 
Hello
shh0ya@VM-Shh0ya:~/01_CTF/116ea16dbeabe08d1fe8891a27d0f16b$ ./simple_machine target 
CODEGATE2020{aaa}
```

`target` 바이너리를 읽어 입력을 받는 것으로 예상할 수 있다. 추적하기 위해 `read` 함수를 기준으로 분석을 시작한다.



