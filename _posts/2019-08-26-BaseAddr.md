---
layout: article
title: "[Rev]GetModuleBaseAddress"
key: 20190826
tags:
  - Dev
  - Reversing
toc: true
mathjax: true
mathjax_autoNumber: true
published : true
---

# [+] Get Module Base address

<!--more-->

Externel 치트를 개발할 때 필요한 함수다.

프로세스는 `OpenProcess`와 같은 제공된 API가 있지만 특정 모듈에 접근해야 할 때는 아래와 같은 코드를 이용하여 주소를 획득 할 수 있다.

```c++
#include <iostream>
#include <Windows.h>
#include <TlHelp32.h>

using namespace std;

DWORD64 GetModuleBaseAddress(DWORD PID, const wchar_t* modName)
{
	uintptr_t modBaseAddr = 0;
	HANDLE hSnap = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32, PID);
	if (hSnap != INVALID_HANDLE_VALUE)
	{
		MODULEENTRY32 modEntry;
		modEntry.dwSize = sizeof(modEntry);
		if (Module32First(hSnap, &modEntry))
		{
			do
			{
				if (!_wcsicmp(modEntry.szModule, modName))
				{
					modBaseAddr = (uintptr_t)modEntry.modBaseAddr;
					break;
				}
			} while (Module32Next(hSnap, &modEntry));
		}
	}
	CloseHandle(hSnap);
	return modBaseAddr;
}

int main()
{
	cout << "[+] Get Module Base Address [+]" << endl;
	uintptr_t base = GetModuleBaseAddress(10104, L"ws2_32.dll");
	cout << "[!] Base Address : " <<hex << base << endl;
}
```

